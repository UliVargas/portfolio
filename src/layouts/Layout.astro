---
interface Props {
	title?: string;
	description?: string;
}

const {
	title = 'Ulises Vargas Flores - Blueprint Engineering Portfolio',
	description = 'Portafolio de desarrollo full-stack con arquitecturas escalables',
} = Astro.props;

import '../styles/global.css';
---

<!doctype html>
<html lang="es" style="visibility: hidden; opacity: 0;">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		
		<!-- Prevent FOUC - Initialize theme before any render -->
		<script is:inline>
			(function() {
				try {
					const savedTheme = localStorage.getItem('theme');
					const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
					const isDark = savedTheme === 'dark' || (!savedTheme && prefersDark);
					if (isDark) {
						document.documentElement.classList.add('dark');
					}
				} catch (e) {}
				// Show page once theme is set
				document.documentElement.style.visibility = 'visible';
				document.documentElement.style.opacity = '1';
			})();
		</script>
		
		<!-- Critical CSS for font fallback -->
		<style is:inline>
			/* System font fallback to prevent layout shift */
			body {
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
			}
			/* Smooth transition when custom fonts load */
			.fonts-loaded body {
				font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, sans-serif;
			}
		</style>
		
		<meta name="generator" content={Astro.generator} />

		<!-- SEO Meta Tags -->
		<meta name="description" content={description} />
		<meta name="author" content="Ulises Vargas Flores" />
		<meta
			name="keywords"
			content="desarrollo full-stack, React, Node.js, TypeScript, arquitectura software, desarrollo web, programador"
		/>
		<link rel="canonical" href={Astro.url.href} />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={Astro.url.href} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={new URL('/og-image.jpg', Astro.url).href} />
		<meta property="og:locale" content="es_ES" />

		<!-- Twitter Card -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:url" content={Astro.url.href} />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content={description} />
		<meta name="twitter:image" content={new URL('/og-image.jpg', Astro.url).href} />

		<title>{title}</title>

		<!-- Preconnect to external domains -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		
		<!-- Preload critical fonts -->
		<link
			rel="preload"
			as="style"
			href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Work+Sans:wght@400;600;800&display=swap"
		/>
		
		<!-- Google Fonts with optimized display -->
		<link
			href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Work+Sans:wght@400;600;800&display=swap"
			rel="stylesheet"
			media="print"
			onload="this.media='all'"
		/>
		<noscript>
			<link
				href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Work+Sans:wght@400;600;800&display=swap"
				rel="stylesheet"
			/>
		</noscript>
	</head>
	<body
		class="bg-background-light dark:bg-background-dark text-black dark:text-white font-body transition-colors duration-300 min-h-screen flex flex-col items-center p-2 sm:p-4 lg:p-8"
	>
		<div
			class="w-full max-w-7xl mx-auto bg-background-light dark:bg-background-dark border-3 border-black dark:border-white rounded-2xl sm:rounded-3xl relative overflow-hidden shadow-neobrutalism dark:shadow-neobrutalism-dark min-h-[90vh]"
		>
			<!-- Blueprint Overlay -->
			<div class="blueprint-overlay"></div>

			<!-- Blueprint Schema -->
			<div class="blueprint-schema">
				<div class="schema-line schema-line-1"></div>
				<div class="schema-line schema-line-2"></div>
				<div class="schema-line schema-line-3"></div>
				<div class="schema-line schema-line-4"></div>
				<div class="schema-node schema-node-1"></div>
				<div class="schema-node schema-node-2"></div>
				<div class="schema-node schema-node-3"></div>
				<div class="schema-node schema-node-4"></div>
				<div class="absolute schema-arrow"></div>
			</div>

			<slot />
		</div>
		
		<!-- Font loading detection -->
		<script is:inline>
			if (document.fonts && document.fonts.ready) {
				document.fonts.ready.then(() => {
					document.documentElement.classList.add('fonts-loaded');
				});
			} else {
				// Fallback for browsers without Font Loading API
				setTimeout(() => {
					document.documentElement.classList.add('fonts-loaded');
				}, 100);
			}
		</script>
	</body>
</html>
